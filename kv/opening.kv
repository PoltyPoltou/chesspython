#:kivy 2.0.0

<OpeningMoveLabel>:
    has_variant : len(self.gameNode.variations) > 1
    text: self.gameNode.san()
    bold:True
    box_width:self.width*self.sizeFactor
    box_height:self.height*self.sizeFactor
    box_left : self.x  + 0.5*self.width*(1-self.sizeFactor)
    box_right : self.box_left + self.width*self.sizeFactor
    box_bottom : self.y + 0.5*self.height*(1-self.sizeFactor)
    box_top : self.box_bottom + self.height*self.sizeFactor
    line_width:1.5 * self.parent.getScalingFactor() if self.parent is not None else 1.5
    canvas.before:

        Color:
            rgb:self.bgColor
        Rectangle:
            pos:self.box_left,self.box_bottom
            size: self.box_width, self.box_height
    canvas:
        Color:
            rgb:(1,1,1)
        Line:
            points:(self.x, self.center_y, self.box_left - self.line_width, self.center_y) if self.gameNode.parent is not None else ()
            cap:"square"
            width: self.line_width
        Line:
            points:(self.box_right + self.line_width, self.center_y, self.right, self.center_y) if len(self.gameNode.variations)>0 else ()
            cap:"square"
            width: self.line_width
        Line:
            points:(self.right, (self.top_node+1.5)*self.height, self.right, (self.bottom_node+1.5)*self.height) if self.has_variant else ()
            cap:"square"
            width:self.line_width
        Color:
            rgb:(0,0,0)
        Line:
            rectangle:(self.box_left + 0.1*self.box_width,self.box_bottom + 0.1*self.box_height, 0.8*self.box_width,0.8*self.box_height) if self.selected else (0,0,0,0)
            width:self.line_width

<OpeningNavigator>:
    canvas.before:
        PushMatrix
        Scale:
            origin:(self.parent.center_x - self.x, self.parent.center_y - self.y) if self.active and self.parent is not None else (0,0)
            x:self.scaling if self.scaling > 0 else -1/self.scaling
            y:self.scaling if self.scaling > 0 else -1/self.scaling
    canvas.after:
        PopMatrix

<OpeningContainer>:
    canvas.before:
        Color:
            rgb:0.1,0.1,0.1
        Rectangle:
            pos:self.pos
            size:self.size